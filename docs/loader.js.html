<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: loader.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: loader.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import path from 'path';
import createRunners from './createRunners';
import loadAliases from './loaders/alias';
import loadPlugins from './loaders/plugins';
import loadConfig from './loaders/config';
import loadTasks from './loaders/tasks';
import mandatory from './helpers';

const cwd = process.cwd();

const configDir = path.join(cwd, 'gulp', 'config');
const taskDir = path.join(cwd, 'gulp', 'tasks');
const aliasFile = path.join(cwd, 'gulp', 'aliases.yml');

/**
 * Task Loader
 * @module Tasks
 * @see loaders:tasks
 * @description Sets up the loader, checks incoming options and defines defaults
 * for `configDir`, `taskDir`, and `aliasFile` if not provided.
 * @param {Object} gulp the user provided gulp instance
 * @param {Object} options this plugins options
 * @returns {Object} The plugins loaded by `gulp-load-plugins`
 */
export default (gulp = mandatory(), options = mandatory()) => {
  /**
   * If there is not an incoming project `config` option for gulpLoadPluginsConfig
   * create one as the path inside of GLP will pick the `gulp-load-runners`
   * package.json by default
   */
  if (!options.gulpLoadPluginsConfig.config) {
    options.gulpLoadPluginsConfig['config'] = path.join(cwd, 'package.json');
  }

  // Load plugins, provide gulpLoadPluginsConfig
  const plugins = loadPlugins(options.gulpLoadPluginsConfig || {});
  // Load config providing configDir and projectConfig
  const config = loadConfig(
    options.configDir || configDir, options.projectConfig || {}
  );
  // Load runner defintion object, provide aliasFile path
  const aliases = loadAliases(options.aliasFile || aliasFile);

  // Load tasks from taskDir, passing user provided gulp, loaded plugins and config
  loadTasks(options.taskDir || taskDir, gulp, plugins, config);
  createRunners(aliases, gulp, plugins);

  // Return the loaded plugins
  return plugins;
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-alias.html">alias</a></li><li><a href="module-Config.html">Config</a></li><li><a href="module-createRunners.html">createRunners</a></li><li><a href="module-helpers.html">helpers</a></li><li><a href="module-index.html">index</a></li><li><a href="module-plugin.html">plugin</a></li><li><a href="module-Tasks.html">Tasks</a></li></ul><h3>Global</h3><ul><li><a href="global.html#createRunnerTask">createRunnerTask</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Tue May 31 2016 13:12:51 GMT-0700 (PDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
